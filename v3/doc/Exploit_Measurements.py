import numpy as np
import os
import matplotlib.pyplot as plt

def ns(ns):
    return ns  / (1000 * 1000)

# Takes an multidimensional list and plots it in one plot.
# Output is the filename (relative path) of the saved plot (must end with .png)
def plot(values, output, title, x_label='', y_label=''):
    fig, axes = plt.subplots()
    axes.plot(values, linewidth=0.5)
    axes.set_title(title)
    axes.set_ylabel(y_label)
    axes.set_xlabel(x_label)
    plt.autoscale(enable=True, axis='x', tight=True)
    fig.savefig(output)
    #plt.show()
    plt.close(fig)

def main():
    files = list()
    for file in os.listdir('./'):
        if file.endswith('.csv'):
            name = file.split('.')[0]
            tmp = np.genfromtxt(file, delimiter=',')
            if name == 'log_ultrasonic':
                tmp = tmp[:-5]
            else:
                tmp = tmp[:-1]

            mean = np.mean(tmp)
            median = np.mean(tmp)
            maximum = np.max(tmp)
            mininum = np.min(tmp)
            print('')
            print("file " + name + " count " + str(len(tmp)))
            print('min {} ns, {} ms'.format(mininum, ns(mininum)))
            print("mean {} ns, {} ms".format(str(mean), str(ns(mean))))
            print("median {} ns, {} ms".format(str(median), str(ns(median))))
            print("max {} ns, {} ms".format(str(maximum), str(ns(maximum))))
            plot(tmp, '../media/' + name + '.png', name)


if __name__ == '__main__':
    main()
